"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.run = void 0;
// This Source Code Form is subject to the terms of the Mozilla Public
// License, v. 2.0. If a copy of the MPL was not distributed with this
// file, You can obtain one at http://mozilla.org/MPL/2.0/.
const fs_1 = require("fs");
const path_1 = require("path");
const __1 = require("..");
const constants_1 = require("../constants");
const log_1 = require("../log");
const utils_1 = require("../utils");
const run = async (chrome) => {
    const dirs = (0, fs_1.readdirSync)(constants_1.ENGINE_DIR);
    const objDirname = dirs.find((dir) => dir.startsWith('obj-'));
    if (!objDirname) {
        throw new Error(`${utils_1.config.name} needs to be built before you can do this.`);
    }
    const objDir = (0, path_1.resolve)(constants_1.ENGINE_DIR, objDirname);
    if ((0, fs_1.existsSync)(objDir)) {
        (0, utils_1.dispatch)('./mach', ['run'].concat(chrome ? ['-chrome', chrome] : []), constants_1.ENGINE_DIR, true);
    }
    else {
        log_1.log.error(`Unable to locate any built binaries.\nRun |${__1.bin_name} build| to initiate a build.`);
    }
};
exports.run = run;
